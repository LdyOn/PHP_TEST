<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Chat Online</title>
	
	<script type="text/javascript">
		window.onload = function(){
			var sender = "xiaoming";
			var receiver = 'dachun';
			var input = document.getElementById("input");
			input.focus();
			var f = 0;

			//打开一个websocket
			var socket = new WebSocket("ws://192.168.33.10:9501");
			socket.onopen = function(){
				socket.send("xiaoming:dachun:connect");
			};

			//从服务器获取消息
			socket.onmessage = function(event){
				var msg = event.data;
				if(f!==2)
				{
					var node = document.createTextNode(receiver);
					var div = document.createElement('div');
					div.style.backgroundColor = '#B0B0B0';
					div.style.color = 'red';
					div.style.textAlign = 'right';				
					div.appendChild(node);
					document.body.insertBefore(div,input);
				}
				var node = document.createTextNode(msg);
				var div = document.createElement('div');		
				div.style.color = 'blue';
				div.style.padding = "10px";
				div.style.textAlign = 'right';				
				div.appendChild(node);
				document.body.insertBefore(div,input);
				input.scrollIntoView();
				f=2;
			};



			//发送消息给服务器
			input.onchange = function(){
				var msg = sender + ":" + receiver + ":"+input.value;
				if(f!==1){
					var node = document.createTextNode(sender);
					var div = document.createElement('div');		
					div.style.backgroundColor = '#9933CC';
					div.style.textAlign = 'left';				
					div.style.color = 'black';				
					div.appendChild(node);
					document.body.insertBefore(div,input);
				}

				var node = document.createTextNode(input.value);
				var div = document.createElement('div');		
				div.style.color = 'gray';
				div.style.textAlign = 'left';
				div.style.padding = "10px";				
				div.appendChild(node);
				document.body.insertBefore(div,input);

				socket.send(msg);
				input.value = "";
				f=1;
			};
			
		};
		
	</script>
</head>
<body>
	<div></div>
	<input type="" name="" id="input" style="width: 100%;">
	<!-- <button onclick="sendMessage()">提交</button> -->
</body>
</html>